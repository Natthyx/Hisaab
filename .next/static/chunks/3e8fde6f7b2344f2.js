(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,75254,e=>{"use strict";var t=e.i(71645);let r=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim();var a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let s=(0,t.forwardRef)(({color:e="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:n,className:l="",children:o,iconNode:d,...c},u)=>(0,t.createElement)("svg",{ref:u,...a,width:s,height:s,stroke:e,strokeWidth:n?24*Number(i)/Number(s):i,className:r("lucide",l),...c},[...d.map(([e,r])=>(0,t.createElement)(e,r)),...Array.isArray(o)?o:[o]])),i=(e,a)=>{let i=(0,t.forwardRef)(({className:i,...n},l)=>(0,t.createElement)(s,{ref:l,iconNode:a,className:r(`lucide-${e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,i),...n}));return i.displayName=`${e}`,i};e.s(["default",()=>i],75254)},23750,10708,e=>{"use strict";var t=e.i(43476),r=e.i(47163);function a({className:e,type:a,...s}){return(0,t.jsx)("input",{type:a,"data-slot":"input",className:(0,r.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...s})}e.s(["Input",()=>a],23750);var s=e.i(71645),i=e.i(48425),n=s.forwardRef((e,r)=>(0,t.jsx)(i.Primitive.label,{...e,ref:r,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));function l({className:e,...a}){return(0,t.jsx)(n,{"data-slot":"label",className:(0,r.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...a})}n.displayName="Label",e.s(["Label",()=>l],10708)},61653,e=>{"use strict";let t=(0,e.i(75254).default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["default",()=>t])},31739,e=>{"use strict";var t=e.i(43476),r=e.i(61653),r=r,a=e.i(25913),s=e.i(47163);let i=(0,a.cva)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function n({className:e,variant:r,...a}){return(0,t.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,s.cn)(i({variant:r}),e),...a})}function l({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"alert-title",className:(0,s.cn)("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",e),...r})}function o({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"alert-description",className:(0,s.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",e),...r})}function d({title:e="Error",message:a,className:s}){return(0,t.jsxs)(n,{variant:"destructive",className:s,children:[(0,t.jsx)(r.default,{className:"h-4 w-4"}),(0,t.jsx)(l,{children:e}),(0,t.jsx)(o,{children:a})]})}e.s(["ErrorMessage",()=>d],31739)},44345,e=>{"use strict";var t=e.i(20755);async function r(e,r){let a=(0,t.createClient)(),{data:s,error:i}=await a.auth.signInWithPassword({email:e,password:r});if(i)throw Error(i.message);return s}async function a(e,r){let a=(0,t.createClient)(),{data:s,error:i}=await a.auth.signUp({email:e,password:r});if(i)throw Error(i.message);if(s.user){let e=await fetch("/api/auth/create-profile",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:s.user.id,email:s.user.email})}),t=await e.json();if(!e.ok||!t.success)throw Error(t.error||"Failed to create user profile")}return s}async function s(e,r){let a=(0,t.createClient)(),s=new FormData;s.append("full_name",r);let i=await fetch("/api/users/update",{method:"POST",body:s}),n=await i.json();if(!i.ok||!n.success)throw Error(n.error||"Failed to update profile");let{error:l}=await a.auth.updateUser({data:{full_name:r,display_name:r}});if(l)throw Error("Profile updated in database but failed to update display name");return n}async function i(e,r,a){let s=(0,t.createClient)(),{data:i,error:n}=await s.auth.signInWithPassword({email:e,password:r});if(n)throw Error("Current password is incorrect");let{error:l}=await s.auth.updateUser({password:a});if(l)throw Error(l.message||"Failed to update password");return{success:!0}}async function n(e){let r=(0,t.createClient)(),{data:a,error:s}=await r.from("users").select("full_name").eq("id",e).single();if(s)throw Error(s.message);return a}e.s(["changePassword",()=>i,"fetchUserProfile",()=>n,"signInWithEmailAndPassword",()=>r,"signUpWithEmailAndPassword",()=>a,"updateProfile",()=>s])},38354,e=>{"use strict";function t(e,t){let r={};return e?/\S+@\S+\.\S+/.test(e)||(r.email="Email address is invalid"):r.email="Email is required",t?t.length<6&&(r.password="Password must be at least 6 characters"):r.password="Password is required",{isValid:0===Object.keys(r).length,errors:r}}function r(e,t,r){let a={};return e?/\S+@\S+\.\S+/.test(e)||(a.email="Email address is invalid"):a.email="Email is required",t?t.length<6&&(a.password="Password must be at least 6 characters"):a.password="Password is required",r?t!==r&&(a.confirmPassword="Passwords do not match"):a.confirmPassword="Please confirm your password",{isValid:0===Object.keys(a).length,errors:a}}e.s(["validateLoginForm",()=>t,"validateSignupForm",()=>r])},89954,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(18566),s=e.i(67881),i=e.i(23750),n=e.i(10708),l=e.i(70065),o=e.i(31739),d=e.i(20755),c=e.i(46696),u=e.i(38354),m=e.i(44345);async function p(e){let t=(0,d.createClient)(),{data:r,error:a}=await t.from("accounts").select("*").eq("user_id",e).order("name");if(a)throw Error(a.message);return r}async function f(e){try{let t=await p(e);return t&&t.length>0}catch(e){return!1}}function h(){let e=(0,a.useRouter)(),[p,h]=(0,r.useState)(""),[g,w]=(0,r.useState)(""),[x,v]=(0,r.useState)(!1),[b,y]=(0,r.useState)({}),[j,N]=(0,r.useState)(null),P=(0,d.createClient)();(0,r.useEffect)(()=>{(async()=>{let{data:{user:t}}=await P.auth.getUser();t&&(await f(t.id)?e.push("/dashboard"):e.push("/setup"))})()},[e,P]);let C=async t=>{t.preventDefault(),N(null);let r=(0,u.validateLoginForm)(p,g);if(!r.isValid){y(r.errors),c.toast.error("Please fix the errors below");return}v(!0);try{let t=await (0,m.signInWithEmailAndPassword)(p,g);c.toast.success("Login successful! Redirecting..."),t.user&&(await f(t.user.id)?e.push("/dashboard"):e.push("/setup"))}catch(e){N(e.message||"An unexpected error occurred"),v(!1)}};return(0,t.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-gradient-to-br from-indigo-50 to-white p-4",children:(0,t.jsxs)(l.Card,{className:"w-full max-w-md",children:[(0,t.jsxs)(l.CardHeader,{className:"space-y-1",children:[(0,t.jsx)(l.CardTitle,{className:"text-3xl font-bold text-center",children:"Hisaab"}),(0,t.jsx)(l.CardDescription,{className:"text-center",children:"Sign in to manage your expenses"})]}),(0,t.jsxs)(l.CardContent,{children:[j&&(0,t.jsx)("div",{className:"mb-4",children:(0,t.jsx)(o.ErrorMessage,{title:"Login Failed",message:j})}),(0,t.jsxs)("form",{onSubmit:C,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{htmlFor:"email",children:"Email"}),(0,t.jsx)(i.Input,{id:"email",type:"email",placeholder:"you@example.com",value:p,onChange:e=>{h(e.target.value),b.email&&y(e=>({...e,email:void 0})),j&&N(null)},className:b.email?"border-red-500":""}),b.email&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:b.email})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{htmlFor:"password",children:"Password"}),(0,t.jsx)(i.Input,{id:"password",type:"password",placeholder:"••••••••",value:g,onChange:e=>{w(e.target.value),b.password&&y(e=>({...e,password:void 0})),j&&N(null)},className:b.password?"border-red-500":""}),b.password&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:b.password})]}),(0,t.jsx)(s.Button,{type:"submit",className:"w-full bg-indigo-600 hover:bg-indigo-700",disabled:x,children:x?"Signing in...":"Sign In"}),(0,t.jsxs)("div",{className:"text-center text-sm text-muted-foreground",children:["Don't have an account?"," ",(0,t.jsx)("button",{type:"button",onClick:()=>e.push("/signup"),className:"text-indigo-600 hover:underline",disabled:x,children:"Sign up"})]})]})]})]})})}e.s(["default",()=>h],89954)}]);