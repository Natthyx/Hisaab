{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///Users/natezeleke/Desktop/Main_Project/Hisaab/app/api/auth/create-profile/route.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js'\n\nexport async function POST(req: Request) {\n  try {\n    const { userId, email } = await req.json()\n\n    const supabase = createClient(\n      process.env.NEXT_PUBLIC_SUPABASE_URL!,\n      process.env.SUPABASE_SERVICE_KEY! // bypasses RLS\n    )\n\n    // Try to insert the user profile\n    const { error } = await supabase\n      .from(\"users\")\n      .upsert([\n        { \n          id: userId, \n          email: email,\n          full_name: null,\n          default_account_id: null,\n          created_at: new Date().toISOString()\n        }\n      ], {\n        onConflict: 'id'\n      })\n\n    if (error) {\n      console.error('Error creating user profile:', error)\n      // If the error is due to a missing table, we should provide a more helpful message\n      if (error.message.includes('relation') || error.message.includes('table')) {\n        return Response.json({ \n          error: 'Database schema not set up. Please run the database schema script.', \n          details: error.message \n        }, { status: 400 })\n      }\n      return Response.json({ error: error.message }, { status: 400 })\n    }\n\n    return Response.json({ success: true })\n  } catch (error: any) {\n    console.error('Unexpected error:', error)\n    return Response.json({ error: 'An unexpected error occurred', details: error.message }, { status: 500 })\n  }\n}"],"names":[],"mappings":";;;;AAAA;;AAEO,eAAe,KAAK,GAAY;IACrC,IAAI;QACF,MAAM,EAAE,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,IAAI,IAAI;QAExC,MAAM,WAAW,IAAA,yMAAY,gFAE3B,QAAQ,GAAG,CAAC,oBAAoB;QAGlC,iCAAiC;QACjC,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,SACrB,IAAI,CAAC,SACL,MAAM,CAAC;YACN;gBACE,IAAI;gBACJ,OAAO;gBACP,WAAW;gBACX,oBAAoB;gBACpB,YAAY,IAAI,OAAO,WAAW;YACpC;SACD,EAAE;YACD,YAAY;QACd;QAEF,IAAI,OAAO;YACT,QAAQ,KAAK,CAAC,gCAAgC;YAC9C,mFAAmF;YACnF,IAAI,MAAM,OAAO,CAAC,QAAQ,CAAC,eAAe,MAAM,OAAO,CAAC,QAAQ,CAAC,UAAU;gBACzE,OAAO,SAAS,IAAI,CAAC;oBACnB,OAAO;oBACP,SAAS,MAAM,OAAO;gBACxB,GAAG;oBAAE,QAAQ;gBAAI;YACnB;YACA,OAAO,SAAS,IAAI,CAAC;gBAAE,OAAO,MAAM,OAAO;YAAC,GAAG;gBAAE,QAAQ;YAAI;QAC/D;QAEA,OAAO,SAAS,IAAI,CAAC;YAAE,SAAS;QAAK;IACvC,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,qBAAqB;QACnC,OAAO,SAAS,IAAI,CAAC;YAAE,OAAO;YAAgC,SAAS,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACxG;AACF"}}]
}